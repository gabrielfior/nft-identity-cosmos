# Cosmwasm contracts

This is a starter repo from Beaker (https://github.com/osmosis-labs/beaker), which we used for quicker development and scaffolding, together with LocalOsmosis (https://github.com/osmosis-labs/LocalOsmosis). Please note that our target chain will be Neutron due to connectivity to other chains.

This folder is divided into two subfolders:

1. **counter** - encompasses logic for adding tuples to a queue stored in the smart contract state. Each tuple consists of `(encryptedWalletAddress:string, recipient: string)`, which are processed by an external service (see `backend` folder), who generates tags for the encryptedWallet and mints NFTs to the `recipient` address.

2. **nft-generator** - encompasses logic for minting NFTs for the tags generated by an external service (see `backend` folder). This is heavily inspired by a series of cw-nfts [repositories](https://github.com/CosmWasm/cw-nfts).


## Getting started

- Install Beaker (https://github.com/osmosis-labs/beaker)
- Start LocalOsmosis (see link above)
- Deploy counter smart contract on LocalOsmosis `$ beaker wasm deploy counter --signer-account test1 --no-wasm-opt --raw '{}'`
- Add new encrypted wallet and recipient to queue `$ beaker wasm execute counter --raw '{ "add_recipient_to_queue": {"caller":"abc","recipient":"def"} }' --signer-account test1`
- Fetch tuples to be processed from queue `$ beaker wasm query counter --raw '{"get_caller_recipient": {}}'`

- Deploy nft-generator contract (we use LocalOsmosis test account # 1) `$ beaker wasm deploy nft-generator --signer-account test1 --no-wasm-opt --raw '{"admin":"osmo1cyyzpxplxdzkeea7kwsydadg87357qnahakaks","name":"nft-generator","symbol":"nftg","minter":"osmo1cyyzpxplxdzkeea7kwsydadg87357qnahakaks"}'
  `
- Mint a new NFT `$ beaker wasm execute nft-generator --raw '{ "mint": {"token_id":"1","owner":"osmo1cyyzpxplxdzkeea7kwsydadg87357qnahakaks","token_uri":"crab"} }' --signer-account test1`
- Check all NFTs that were minted `$  beaker wasm query nft-generator --raw '{"all_tokens":{}}'`